<!DOCTYPE html>
<html>
  <head>
    <title>Production Experiment</title>
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <script src="../plugin/plugin-html-multi-slider-response.js"></script>
    <script src="../plugin/plugin-html-button-response.js"></script>
    <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
    <style>
      img {
        width: 600px;
      }
    </style>
  </head>
  <body></body>

  <script>

    var jsPsych = initJsPsych({
      default_iti: 250, 
      on_finish: function() {
        jsPsych.data.displayData();
      }
    });


    var consent_form = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p> This is the consent form.(To be edited)</p >',
      choices: ['Continue']
    };


    var instruction = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<p> You are a player in a video game, and your goal is to earn money as quickly as possible. <br> Please follow the instructions to check the condition of your characters.</p >',
      choices: ['Continue']
    };
    
    
    var instruction_energy = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<img src="images_production/instruction_energy.png" style="width:500px; height:auto; margin: 30px auto;">' +
        '<p> Here is your character.<br> Through the dialogue box, you can check his energy level on the energy bar,<br> and the descriptive sentence about his condition will adjust accordingly. </p >',
      choices: ['Continue']
    };

    var instruction_pet = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<img src="images_production/instruction_pet.png" style="width:500px; height:auto; margin: 30px auto;">' +
      '<p> Here is your pet.<br> Through the dialogue box, you can check its blood sugar level on the energy bar,<br> and the descriptive sentence about its condition will adjust accordingly.</p >',
      choices: ['Continue']
    };

    var instruction_wealth = {
      type: jsPsychHtmlButtonResponse,
      stimulus: '<img src="images_production/instruction_wealth.png" style="width:500px; height:auto; margin: 30px auto;">' +
      '<p> Here is your character.<br> Through the dialogue box, you can check his financial status on the wealth bar,<br> and the descriptive sentence about his condition will adjust accordingly.</p >',
      choices: ['Continue']
    };


    function createTrial(imageType, imageNumber, labels) {
    return {
        type: jsPsychHtmlMultiSliderResponse,
        stimulus: `<img src="images_production/${imageType}${imageNumber}.png" style="width:500px; height:auto; margin: 30px auto;">` +
        '<p>How likely do you think the dialogue box will display the following sentences ? <br> Make sure that your responses sum up to 100.</p>',
        num_sliders: 3,
        force_total: 100,
        slider_labels: labels,
        slider_width: 800,
        prompt: ''
    };
}

    // energy trials
    var energy_trials = [];
    for (let i = 1; i <= 9; i++) {
        energy_trials.push(createTrial('energy', i, ["Your character is tired", "Your character is exhausted", "something else"]));
    }

    var energy_trials_round2 = [];
    for (let i = 1; i <= 9; i++) {
        energy_trials_round2.push(createTrial('energy', i, ["Your character is tired", "Your character is exhausted", "something else"]));
    }

    // pet trials
    var pet_trials = [];
    for (let i = 1; i <= 9; i++) {
        pet_trials.push(createTrial('pet', i, ["Your pet is hungry", "Your dog is starving", "something else"]));
    }

    var pet_trials_round2 = [];
    for (let i = 1; i <= 9; i++) {
        pet_trials_round2.push(createTrial('pet', i, ["Your pet is hungry", "Your dog is starving", "something else"], ));
    }

    // wealth trials
    var wealth_trials = [];
    for (let i = 1; i <= 9; i++) {
        wealth_trials.push(createTrial('wealth', i, ["Your character is poor", "Your character is destitute", "something else"], ));
    }

    var wealth_trials_round2 = [];
    for (let i = 1; i <= 9; i++) {
        wealth_trials_round2.push(createTrial('wealth', i, ["Your character is poor", "Your character is destitute", "something else"]));
    }

 


    var timeline_energy = [];
    timeline_energy = timeline_energy.concat(energy_trials); // adding first round trials
    timeline_energy = timeline_energy.concat(energy_trials_round2); // adding second trials

    var timeline_pet = [];
    timeline_pet = timeline_pet.concat(pet_trials); // adding first round trials
    timeline_pet = timeline_pet.concat(pet_trials_round2); // adding second trials 


    var timeline_wealth = [];
    timeline_wealth = timeline_wealth.concat(wealth_trials); // adding first round trials
    timeline_wealth = timeline_wealth.concat(wealth_trials_round2); // adding second trials


    
    // randomdized
    var shuffled_timeline_e = jsPsych.randomization.shuffle(timeline_energy);
    var shuffled_timeline_p = jsPsych.randomization.shuffle(timeline_pet);
    var shuffled_timeline_w = jsPsych.randomization.shuffle(timeline_wealth);

    timeline = [consent_form].concat(instruction, instruction_energy, shuffled_timeline_e, instruction_pet, shuffled_timeline_p, instruction_wealth, shuffled_timeline_w)


    // run
    jsPsych.run(timeline);


  </script>
</html>